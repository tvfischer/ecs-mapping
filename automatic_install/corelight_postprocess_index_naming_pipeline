{
  "description": "Corelight index naming pipeline",
  "processors": [

    {
      "set": {
        "description": "set index name prefix for non metrics,stats,system,etc",
        "field": "temporary_metadata_index_name_prefix",
        "value": "ecs-corelight",
        "if": "ctx.temporary_metadata_is_metric_log == 'no' && ctx.temporary_metadata_is_stats_log == 'no' && ctx.temporary_metadata_is_system_log == 'no'"
      }
    },
    {
      "set": {
        "description": "set index name prefix for metrics,stats,system,etc",
        "field": "temporary_metadata_index_name_prefix",
        "value": "ecs-corelight-zeek",
        "if": "ctx.temporary_metadata_is_metric_log == 'yes' || ctx.temporary_metadata_is_stats_log == 'yes' || ctx.temporary_metadata_is_system_log == 'yes'"
      }
    },
    {
      "set": {
        "description": "Parsed log, thus would have temporary_metadata_index_name_suffix field set.",
        "field": "_index",
        "value": "{{temporary_metadata_index_name_prefix}}-{{temporary_metadata_index_name_suffix}}",
        "if": "ctx.temporary_metadata_index_name_suffix != null"
      }
    },
    {
      "set" : {
        "description": "Log not parsed, thus would not have temporary_metadata_index_name_suffix field set. Thus should be placed in own index to prevent field collisions",
        "field" : "_index",
        "value" : "ecs-corelight-temporary",
        "if": "ctx.temporary_metadata_index_name_suffix == null"
      }
    }
  ]
}




